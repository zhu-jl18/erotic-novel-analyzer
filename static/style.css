/* 小说分析器 - Gemini 风格 */

/* 高级质感变量 */
:root {
    --radius: 1rem;
    --card-shadow: none;
}

/* 纯黑主题 */
[data-theme="dark"] {
    --b1: 0% 0 0;
    --b2: 6% 0 0;
    --b3: 10% 0 0;
    --bc: 98% 0 0;
    --glass: rgba(255,255,255,0.04);
    --glass-hover: rgba(255,255,255,0.08);
    --glass-border: rgba(255,255,255,0.06);
    --text-secondary: rgba(255,255,255,0.5);
    --card-shadow: none;
}

/* 纯白主题 - 强制高对比度 */
[data-theme="light"] {
    --b1: 97% 0.006 260;
    --b2: 95.5% 0.007 260;
    --b3: 92% 0.009 260;
    --bc: 0% 0 0;
    --glass: #ffffff;
    --glass-hover: #f5f7fb;
    --glass-border: rgba(0, 0, 0, 0.12);
    --text-secondary: #374151;
    --card-shadow: 0 1px 3px rgba(0,0,0,0.1), 0 4px 12px rgba(0,0,0,0.05);
}

[data-theme="light"] body {
    color: #111827;
}

[data-theme="light"] .opacity-60,
[data-theme="light"] .opacity-50,
[data-theme="light"] .opacity-40 {
    opacity: 1 !important;
    color: #374151;
}

[data-theme="light"] .quick-stat-title,
[data-theme="light"] .meta-label,
[data-theme="light"] .detail-label,
[data-theme="light"] .char-role,
[data-theme="light"] .summary-content,
[data-theme="light"] .scene-location,
[data-theme="light"] .progress-desc,
[data-theme="light"] .scene-chapter-small,
[data-theme="light"] .scene-location-small {
    color: #374151 !important;
    opacity: 1 !important;
}

[data-theme="light"] .quick-stat-value,
[data-theme="light"] .char-name,
[data-theme="light"] .summary-title,
[data-theme="light"] .scene-participants,
[data-theme="light"] .scene-participants-small,
[data-theme="light"] .progress-stage,
[data-theme="light"] .scene-chapter {
    color: #111827 !important;
}

[data-theme="light"] .meta-value,
[data-theme="light"] .detail-value,
[data-theme="light"] .scene-description,
[data-theme="light"] .thunderzone-desc,
[data-theme="light"] .thunderzone-type {
    color: #1f2937 !important;
}

[data-theme="light"] .text-primary {
    color: #4f46e5 !important;
}

[data-theme="light"] .text-secondary {
    color: #ec4899 !important;
}

[data-theme="light"] .text-info {
    color: #3b82f6 !important;
}

[data-theme="light"] .text-error {
    color: #ef4444 !important;
}

[data-theme="light"] .text-success {
    color: #22c55e !important;
}

[data-theme="light"] .text-warning {
    color: #f59e0b !important;
}

/* Alpine.js cloak */
[x-cloak] { display: none !important; }

/* 自定义滚动条 - 极简 */
::-webkit-scrollbar { width: 4px; height: 4px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: var(--glass-hover); border-radius: 2px; }

/* 微动效 */
@keyframes fadeInUp {
    from { opacity: 0; transform: translateY(12px); }
    to { opacity: 1; transform: translateY(0); }
}
.animate-in { animation: fadeInUp 0.4s ease-out; }

/* 通用卡片阴影应用 */
.glass-card, .char-card, .sex-scene-card, .thunderzone-card, .count-display, 
.summary-section, .novel-meta-section, .char-names-section, .scene-item, .progress-item, .float-input {
    box-shadow: var(--card-shadow);
}

/* 玻璃卡片 */
.glass-card {
    background: var(--glass);
    border-radius: var(--radius);
    border: 1px solid var(--glass-border);
    transition: background 0.2s, transform 0.2s, box-shadow 0.2s;
}
.glass-card:hover {
    background: var(--glass-hover);
}

/* Pill Tab */
.pill-tabs { display: flex; gap: 0.25rem; }
.pill-tab {
    padding: 0.5rem 1rem;
    border-radius: 2rem;
    font-size: 0.875rem;
    font-weight: 500;
    color: var(--text-secondary);
    background: transparent;
    border: none;
    cursor: pointer;
    transition: all 0.2s;
}
.pill-tab:hover { background: var(--glass); color: oklch(var(--bc)); }
.pill-tab.active { background: var(--glass-hover); color: oklch(var(--bc)); font-weight: 600; }
[data-theme="light"] .pill-tab.active { background: white; box-shadow: var(--card-shadow); }

/* 悬浮输入框 */
.float-input {
    background: var(--glass);
    border: none;
    border-radius: var(--radius);
    padding: 0.875rem 1.25rem;
    transition: background 0.2s, box-shadow 0.2s;
    border: 1px solid var(--glass-border);
}
.float-input:hover, .float-input:focus-within {
    background: var(--glass-hover);
    box-shadow: 0 8px 32px rgba(0,0,0,0.12);
}

/* 关系图容器 */
#relationshipChart {
    position: relative;
    overflow: hidden;
    background: var(--glass);
    border: 1px solid var(--glass-border);
    border-radius: var(--radius);
    box-shadow: var(--card-shadow);
}
#relationshipChart svg {
    width: 100%;
    height: 100%;
}

/* 角色卡片网格 */
.char-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
    gap: 1.5rem;
}

/* 角色卡片 - 玻璃风格 */
.char-card {
    background: var(--glass);
    border: 1px solid var(--glass-border);
    border-radius: var(--radius);
    padding: 1.5rem;
    transition: background 0.2s, transform 0.2s;
}
.char-card:hover {
    background: var(--glass-hover);
    transform: translateY(-2px);
}

.char-header {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-bottom: 1rem;
}
.char-avatar {
    width: 48px;
    height: 48px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 600;
    color: white;
}
.char-avatar.male { background: oklch(var(--in)); }
.char-avatar.female { background: oklch(var(--er)); }

.char-name { font-size: 1.125rem; font-weight: 600; }
.char-role { font-size: 0.75rem; opacity: 0.6; margin-top: 0.25rem; }

.char-details { display: flex; flex-direction: column; gap: 0.75rem; }
.char-detail { display: flex; flex-direction: column; gap: 0.25rem; }
.detail-label { font-size: 0.7rem; opacity: 0.5; text-transform: uppercase; }
.detail-value { font-size: 0.875rem; opacity: 0.8; }

.char-detail.sexual {
    margin-top: 0.75rem;
    padding-top: 0.75rem;
    border-top: 1px solid var(--glass-border);
}
.char-detail.lewdness {
    margin: 0.75rem -1.5rem -1.5rem;
    padding: 1rem 1.5rem;
    background: oklch(var(--er) / 0.08);
    border-radius: 0 0 var(--radius) var(--radius);
}
.lewdness-text { color: oklch(var(--er)); font-style: italic; }

.lewdness-badge {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 0.5rem 0.75rem;
    border-radius: 0.5rem;
    margin-left: auto;
}
.lewdness-rank { font-size: 0.7rem; opacity: 0.8; }
.lewdness-score { font-size: 1.25rem; font-weight: 700; color: white; }

/* 多角色分区 */
.multi-char-section { margin-bottom: 1.5rem; }
.multi-char-section h3 {
    font-size: 0.875rem;
    font-weight: 600;
    opacity: 0.7;
    margin-bottom: 0.75rem;
    padding-bottom: 0.5rem;
    border-bottom: 1px solid var(--glass-border);
}

/* 场景卡片 - 玻璃风格 */
.sex-scene-card {
    background: var(--glass);
    border: 1px solid var(--glass-border);
    border-radius: var(--radius);
    padding: 1.5rem;
    margin-bottom: 1rem;
    transition: background 0.2s;
}
.sex-scene-card:hover { background: var(--glass-hover); }
.scene-header { display: flex; align-items: center; gap: 0.75rem; margin-bottom: 1rem; }
.scene-badge {
    background: oklch(var(--er));
    color: white;
    padding: 0.25rem 0.75rem;
    border-radius: 0.375rem;
    font-size: 0.75rem;
    font-weight: 600;
}
.scene-participants { color: oklch(var(--p)); font-weight: 600; }
.scene-chapter { font-weight: 600; }
.scene-location { font-size: 0.875rem; opacity: 0.7; margin-bottom: 0.75rem; }
.scene-description { font-size: 0.875rem; opacity: 0.8; line-height: 1.6; }

/* 统计展示 */
.count-display {
    text-align: center;
    padding: 3rem 2rem;
    background: var(--glass);
    border: 1px solid var(--glass-border);
    border-radius: var(--radius);
    margin-bottom: 1.5rem;
}
.count-number {
    font-size: 5rem;
    font-weight: 700;
    background: linear-gradient(135deg, oklch(var(--p)), oklch(var(--s)));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}
.count-label { font-size: 1rem; color: var(--text-secondary); margin-top: 0.5rem; }

.scenes-timeline { display: flex; flex-direction: column; gap: 0.75rem; }
.scene-item {
    display: flex;
    align-items: center;
    padding: 1rem 1.25rem;
    background: var(--glass);
    border: 1px solid var(--glass-border);
    border-radius: var(--radius);
    transition: background 0.2s;
}
.scene-item:hover { background: var(--glass-hover); }
.scene-number {
    width: 2rem;
    height: 2rem;
    border-radius: 50%;
    background: oklch(var(--p));
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.75rem;
    font-weight: 600;
    margin-right: 0.75rem;
    flex-shrink: 0;
}
.scene-info { flex: 1; min-width: 0; }
.scene-participants-small { font-weight: 500; margin-bottom: 0.25rem; }
.scene-chapter-small { font-size: 0.875rem; }
.scene-location-small { font-size: 0.75rem; opacity: 0.6; }
.more-scenes { text-align: center; padding: 0.75rem; opacity: 0.6; font-size: 0.875rem; }

/* 发展时间线 */
.progress-timeline {
    position: relative;
    padding-left: 1.5rem;
}
.progress-timeline::before {
    content: '';
    position: absolute;
    left: 0.5rem;
    top: 0;
    bottom: 0;
    width: 2px;
    background: var(--glass-hover);
}
.progress-item {
    position: relative;
    padding: 1.25rem;
    background: var(--glass);
    border: 1px solid var(--glass-border);
    border-radius: var(--radius);
    margin-bottom: 0.75rem;
    transition: background 0.2s;
}
.progress-item:hover { background: var(--glass-hover); }
.progress-dot {
    position: absolute;
    left: -1.5rem;
    top: 1.25rem;
    width: 0.75rem;
    height: 0.75rem;
    border-radius: 50%;
    background: oklch(var(--p));
    border: 2px solid oklch(var(--b1));
}
.progress-dot.first {
    background: oklch(var(--er));
    width: 1rem;
    height: 1rem;
    left: -1.625rem;
}
.progress-chapter { font-size: 0.75rem; opacity: 0.6; margin-bottom: 0.25rem; }
.progress-stage { font-size: 1rem; font-weight: 600; margin-bottom: 0.5rem; }
.progress-desc { font-size: 0.875rem; opacity: 0.8; line-height: 1.5; }

/* 总结区域 */
.summary-section {
    background: var(--glass);
    border: 1px solid var(--glass-border);
    padding: 1.5rem;
    border-radius: var(--radius);
    margin-top: 1rem;
    margin-bottom: 1rem;
}
.summary-title {
    font-size: 0.875rem;
    font-weight: 600;
    color: oklch(var(--p));
    margin-bottom: 0.75rem;
}
.summary-content { font-size: 0.9375rem; color: var(--text-secondary); line-height: 1.8; }

/* 小说元信息 */
.novel-meta-section {
    background: var(--glass);
    border: 1px solid var(--glass-border);
    padding: 1.5rem;
    border-radius: var(--radius);
    margin-bottom: 1rem;
}
.novel-meta-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 1rem;
    margin-top: 0.75rem;
}
.novel-meta-item { display: flex; flex-direction: column; gap: 0.25rem; }
.meta-label { font-size: 0.7rem; color: var(--text-secondary); text-transform: uppercase; }
.meta-value { font-size: 0.875rem; opacity: 0.8; }
.meta-value.completed { color: oklch(var(--su)); }
.meta-value.ongoing { color: oklch(var(--wa)); }

/* 快速统计 */
.quick-stats-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 1rem;
}
.quick-stat { display: flex; flex-direction: column; gap: 0.25rem; min-width: 0; }
.quick-stat-title { font-size: 0.7rem; color: var(--text-secondary); text-transform: uppercase; }
.quick-stat-value { font-size: 2.5rem; font-weight: 700; line-height: 1.1; }

/* 角色名称展示 */
.char-names-section {
    background: var(--glass);
    border: 1px solid var(--glass-border);
    padding: 1.5rem;
    border-radius: var(--radius);
    margin-bottom: 1rem;
}
.char-names-grid {
    display: flex;
    flex-direction: column;
    gap: 1rem;
    margin-top: 0.75rem;
}
.char-names-group {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}
.char-group-label {
    font-size: 0.8125rem;
    opacity: 0.5;
    font-weight: 500;
}
.char-names-list { display: flex; flex-wrap: wrap; gap: 0.5rem; }
.char-name-tag {
    padding: 0.375rem 0.875rem;
    border-radius: 0.375rem;
    font-size: 0.875rem;
    font-weight: 500;
    background: oklch(var(--b3));
    color: oklch(var(--bc));
    transition: opacity 0.2s;
}
.char-name-tag:hover { opacity: 0.8; }
.char-name-tag.male { background: oklch(var(--in) / 0.15); color: oklch(var(--in)); }
.char-name-tag.female { background: oklch(var(--er) / 0.15); color: oklch(var(--er)); }

/* 空状态 */
.empty-state {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    min-height: 50vh;
    color: var(--text-secondary);
}
.empty-icon { font-size: 4rem; margin-bottom: 1.5rem; opacity: 0.3; }
.empty-text { font-size: 1.125rem; }

/* 响应式 */
@media (max-width: 768px) {
    .char-grid { grid-template-columns: 1fr; }
    .novel-meta-grid { grid-template-columns: 1fr; }
    .char-names-grid { grid-template-columns: 1fr; }
    .quick-stats-grid { grid-template-columns: repeat(2, 1fr); }
    .quick-stat-value { font-size: 2rem; }
    .pill-tabs { flex-wrap: wrap; }
}

/* 雷点相关样式 */
.thunderzone-list {
    display: flex;
    flex-direction: column;
    gap: 1rem;
    margin-top: 1rem;
}

.thunderzone-card {
    background: var(--glass);
    border: 1px solid var(--glass-border);
    border-radius: var(--radius);
    padding: 1.5rem;
    transition: background 0.2s, transform 0.2s;
}

.thunderzone-card:hover {
    background: var(--glass-hover);
    transform: translateY(-2px);
}

.thunderzone-card.thunderzone-high {
    background: oklch(var(--er) / 0.08);
    border-color: oklch(var(--er) / 0.2);
}
.thunderzone-card.thunderzone-high:hover {
    background: oklch(var(--er) / 0.12);
}

.thunderzone-header {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    margin-bottom: 1rem;
}

.thunderzone-icon {
    font-size: 1.5rem;
    line-height: 1;
}

.thunderzone-type {
    font-size: 1rem;
    font-weight: 600;
    color: oklch(var(--bc));
}

.thunderzone-body {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
}

.thunderzone-desc {
    font-size: 0.9375rem;
    opacity: 0.8;
    line-height: 1.6;
    margin: 0;
}

.thunderzone-meta {
    display: flex;
    flex-wrap: wrap;
    gap: 1rem;
    font-size: 0.875rem;
    opacity: 0.7;
}

.meta-item {
    display: flex;
    align-items: center;
    gap: 0.25rem;
}

.thunderzone-context {
    font-size: 0.875rem;
    color: var(--text-secondary);
    font-style: italic;
    margin: 0;
    padding-top: 0.5rem;
    border-top: 1px solid var(--glass-border);
}

/* 响应式 - 移动端优化 */
@media (max-width: 768px) {
    .thunderzone-meta {
        flex-direction: column;
        gap: 0.5rem;
    }
    .thunderzone-header {
        flex-wrap: wrap;
    }
    .thunderzone-card {
        padding: 1.25rem;
    }
}

/* 日志样式 */
.log-container {
    scrollbar-width: thin;
}

.log-entry {
    background: var(--glass);
    border: 1px solid var(--glass-border);
    transition: background 0.2s;
}

.log-entry.log-error {
    background: oklch(var(--er) / 0.08);
    border-color: oklch(var(--er) / 0.2);
}

.log-entry.log-warning {
    background: oklch(var(--wa) / 0.08);
    border-color: oklch(var(--wa) / 0.2);
}

.log-entry.log-success {
    background: oklch(var(--su) / 0.08);
    border-color: oklch(var(--su) / 0.2);
}

.log-level-badge {
    font-size: 0.625rem;
    font-weight: 600;
    padding: 0.125rem 0.375rem;
    border-radius: 0.25rem;
    letter-spacing: 0.05em;
}

.log-level-info {
    background: oklch(var(--in) / 0.15);
    color: oklch(var(--in));
}

.log-level-success {
    background: oklch(var(--su) / 0.15);
    color: oklch(var(--su));
}

.log-level-warning {
    background: oklch(var(--wa) / 0.15);
    color: oklch(var(--wa));
}

.log-level-error {
    background: oklch(var(--er) / 0.15);
    color: oklch(var(--er));
}

.log-message {
    word-break: break-word;
}
